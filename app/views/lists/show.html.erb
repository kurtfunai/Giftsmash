<div class="row">
  <div class="span8">
    <h1>
      <%= @list.title %>
      &nbsp;
      <% if can? :update, @list %>
        <%= link_to 'Edit', edit_list_path(@list), :class=>'btn btn-mini list_edit' %>
      <% end %>
      <% if can? :destroy, @list %>
        <%= link_to 'Delete', @list, method: :delete, data: { confirm: 'Are you sure?' }, :class=>'btn btn-mini btn-danger' %>
      <% end %>
      <% if can? :update, @list %>
      <%= link_to 'Back', lists_path , :class=>'btn btn-mini btn-inverse' %>
      <% end %> 
    </h1>
    Event Date: <%= @list.event_date.strftime("%d-%m-%Y")  %>
  </div>
  <% if can? :update, @list %>
  <!--<div class="span6">
    <div class="navbar">  
      <div class="navbar-inner">
        <ul class="nav">
          <li class="nav-text btn-primary"><%= link_to raw('<i class="icon-plus"></i> Add a List Item'), new_list_item_path(@list), :remote => true, :title=>'Add list item', :style=>'color:#fff;text-shadow:none;' %></li>
        </ul>
        <ul id="filters" class="nav nav-pills ">
          <li class="active"><a href="#" data-filter="*">All Items</a></li>
          <li><a href="#" data-filter=".priority-4">Really Want</a></li>
          <li><a href="#" data-filter=".priority-3">Want</a></li>
          <li><a href="#" data-filter=".priority-2">Need</a></li>
          <li><a href="#" data-filter=".priority-1, .priority-0">Like</a></li>
        </ul>
      </div>
    </div>
  </div>-->
  <% end %>
</div>
<div class="row">
  <div class="lead span6">
    <%= simple_format @list.description %>  
  </div>
  
</div><!--  ends container -->
<div class="row">
  <div class="span8">
    <% if can? :update, @list %>
      <%= link_to raw('<i class="icon-plus"></i> Add a List Item'), new_list_item_path(@list), :remote => true, :title=>'Add list item', :class=>'btn btn-primary' %>
    <% end %>

    <div class="btn-toolbar pull-right">
      <div id="sort-by" class="btn-group">
        <button class="btn active" data-sort-by='original-order'>Priority</button>
        <button class="btn" data-sort-by='name'>Name</button>
        <button class="btn" data-sort-by='height'>Size</button>
        <button class="btn" data-sort-by='random'>Random</button>
      </div>
      <div id="sort-direction" class="btn-group" data-option-key="sortAscending">
        <button class="btn active" data-option-value="true"><i class="icon-arrow-up"></i></button>
        <button class="btn" data-option-value="false"><i class="icon-arrow-down"></i></button>
      </div>
    </div>
  </div>
</div>
<div class="clearfix"></div>
<div class="row">
  <div id="item-bin" >
    <% @list.items.order('priority DESC, name ASC').each do |item| %>
    <div id="item_<%= item.id %>" class="item priority-<%= item.priority %> span3" data-priority="<%= item.priority %>" data-id="<%= item.id %>">
      <div class="title">
        <%= item.name %>
      </div>
      <%= simple_format item.description %>
      <% if can? :update, item %>
        <%= link_to raw('<i class="icon-pencil"></i> Edit'), edit_list_item_path(@list, item), :remote => true, :title=>'Edit', :class=>'btn btn-mini' %>
      <% end %>
      <% if can? :destroy, item %>
        <%= link_to raw('<i class="icon-trash"></i> Delete'), list_item_path(@list, item), :remote => true, method: :delete, :title=>'Delete', :class=>'btn btn-mini btn-danger', data: { confirm: 'Are you sure?' } %>
      <% end %>
      <% if cannot? :update, item %>
        www.link.com
      <% end %>
    </div>
    <% end %>
  </div>
</div>
<script>
$('#item-bin').isotope({
  // options
  itemSelector : '.item',
  layoutMode : 'masonry',//masonry, fitRows

  getSortData : {
    name : function ( $elem ) {
      return $elem.find('.title').text().toLowerCase();
    },
    priority : function ( $elem ) {
      return $elem.attr('data-priority');
    },
    orderAdded : function ( $elem ) {
      return $elem.attr('data-id');
    },
    height : function( $elem ) {
      return $elem.height();
    }
  },
  
});

// change sort by
$('#sort-by button').click(function(){
  // Remove Active class from other items, set it to current item
  $('#sort-by').children().removeClass("active");
  $(this).addClass("active");
  // get href attribute, minus the '#'
  var sortName = $(this).attr('data-sort-by');
  $('#item-bin').isotope({ sortBy : sortName });
  return false;
});

// filter items when filter link is clicked
$('#filters a').click(function(){
  $('#filters').children().removeClass("active");
  $(this).parent().addClass("active");
  // grab value from data attribute
  var selector = $(this).attr('data-filter');
  $('#item-bin').isotope({ filter: selector });
  return false;
});

// change sort direction
$('#sort-direction button').click(function(){
  $('#sort-direction').children().removeClass("active");
  $(this).addClass("active");
  // grab true/false value from data attribute
  var selector = $(this).attr('data-option-value');
  selector = selector == "true" ? true : false; // string -> bool
  $('#item-bin').isotope({ sortAscending: selector });
  return false;
});
</script>
<div class="clearfix"></div>